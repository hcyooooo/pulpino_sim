   1              		.file	"gpio.c"
   2              		.option nopic
   3              		.section	.text.set_pin_function,"ax",@progbits
   4              		.align	1
   5              		.weak	set_pin_function
   7              	set_pin_function:
   8 0000 8280     		ret
  10              		.section	.text.startup.main,"ax",@progbits
  11              		.align	1
  12              		.globl	main
  14              	main:
  15 0000 3971     		add	sp,sp,-64
  16 0002 8547     		li	a5,1
  17 0004 3EC2     		sw	a5,4(sp)
  18 0006 8947     		li	a5,2
  19 0008 3EC4     		sw	a5,8(sp)
  20 000a 8D47     		li	a5,3
  21 000c 3EC6     		sw	a5,12(sp)
  22 000e 9147     		li	a5,4
  23 0010 3EC8     		sw	a5,16(sp)
  24 0012 9547     		li	a5,5
  25 0014 3ECA     		sw	a5,20(sp)
  26 0016 9947     		li	a5,6
  27 0018 3ECC     		sw	a5,24(sp)
  28 001a 9D47     		li	a5,7
  29 001c 26DA     		sw	s1,52(sp)
  30 001e 52D4     		sw	s4,40(sp)
  31 0020 06DE     		sw	ra,60(sp)
  32 0022 22DC     		sw	s0,56(sp)
  33 0024 4AD8     		sw	s2,48(sp)
  34 0026 4ED6     		sw	s3,44(sp)
  35 0028 02C0     		sw	zero,0(sp)
  36 002a 3ECE     		sw	a5,28(sp)
  37 002c 0410     		add	s1,sp,32
  38 002e 0A8A     		mv	s4,sp
  39              	.L4:
  40 0030 0B244A00 		p.lw	s0,4(s4!)	# load post inc
  41 0034 8545     		li	a1,1
  42 0036 2285     		mv	a0,s0
  43 0038 97000000 		call	set_gpio_pin_direction
  43      E7800000 
  44 0040 8145     		li	a1,0
  45 0042 2285     		mv	a0,s0
  46 0044 97000000 		call	set_gpio_pin_value
  46      E7800000 
  47 004c E3129AFE 		bne	s4,s1,.L4
  48 0050 0145     		li	a0,0
  49              	.L20:
  50 0052 13090100 		add	s2,sp,0
  51              	.L10:
  52 0056 8545     		li	a1,1
  53 0058 97000000 		call	set_gpio_pin_value
  53      E7800000 
  54 0060 8567     		li	a5,4096
  55 0062 93878738 		add	a5,a5,904
  56 0066 FBC03700 		lp.setup  	x1,a5,(.L37)	 # loop setup, lc+le set
  57              	.L6:
  58              	 #APP
  59              	# 70 "../src/gpio_test/gpio.c" 1
   1              	// #include "gpio.h"
   2              	// #include "string_lib.h"
   3              	// #include "utils.h"
   4              	
   5              	// void delay(volatile int cycles) {
   6              	//     for (volatile int i = 0; i < cycles; i++);
   7              	// }
   8              	
   9              	// int main() {
  10              	//     // è®¾ç½® GPIO0~GPIO7 ä¸ºè¾“å‡º
  11              	//     for (int i = 0; i < 8; i++) {
  12              	//         set_gpio_pin_direction(i, DIR_IN);
  13              	//     }
  14              	
  15              	//     printf("GPIO0~GPIO7 configured as output\n");
  16              	
  17              	//     while (1) {
  18              	//         // å…¨éƒ¨ç½®é«˜
  19              	//         for (int i = 0; i < 8; i++) {
  20              	//             set_gpio_pin_value(i, 1);
  21              	//         }
  22              	//         printf("GPIO0~7 set HIGH\n");
  23              	//         delay(1000000);
  24              	
  25              	//         // å…¨éƒ¨ç½®ä½Ž
  26              	//         for (int i = 0; i < 8; i++) {
  27              	//             set_gpio_pin_value(i, 0);
  28              	//         }
  29              	//         printf("GPIO0~7 set LOW\n");
  30              	//         delay(1000000);
  31              	
  32              	//         // å•ä¸ªå¼•è„šè½®æµç½®é«˜
  33              	//         for (int i = 0; i < 8; i++) {
  34              	//             // å…ˆæ¸…é›¶æ‰€æœ‰
  35              	//             for (int j = 0; j < 8; j++)
  36              	//                 set_gpio_pin_value(j, 0);
  37              	//             set_gpio_pin_value(i, 1);
  38              	//             printf("GPIO%d set HIGH\n", i);
  39              	//             delay(500000);
  40              	//         }
  41              	//     }
  42              	
  43              	//     return 0;
  44              	// }
  45              	// #include "gpio.h"
  46              	
  47              	// int main() {
  48              	//     // è®¾ç½® GPIO0 ä¸ºè¾“å‡º
  49              	//     set_gpio_pin_direction(0, DIR_IN);
  50              	
  51              	//     // å¾ªçŽ¯ç¿»è½¬ GPIO0 è¾“å‡º
  52              	//     while (1) {
  53              	//         set_gpio_pin_value(0, 1);
  54              	//         for (volatile int i = 0; i < 100000; i++);
  55              	//         set_gpio_pin_value(0, 0);
  56              	//         for (volatile int i = 0; i < 100000; i++);
  57              	//     }
  58              	
  59              	//     return 0;
  60              	// }
  61              	#include "gpio.h"
  62              	#include "timer.h"   // å¦‚æžœæ²¡æœ‰è¿™ä¸ªå¤´ï¼Œåˆ æŽ‰æœ¬è¡Œå³å¯
  63              	
  64              	// é¢„é˜²æ€§ï¼šè‹¥åº“é‡Œæ²¡æœ‰å®žçŽ° set_pin_functionï¼Œæä¾›ä¸€ä¸ªå¼±ç¬¦å·ç©ºå®žçŽ°ä»¥é¿å…é“¾æ
  65              	// è‹¥å°†æ¥ä½ æ·»åŠ äº†çœŸæ­£çš„å®žçŽ°ï¼Œé“¾æŽ¥å™¨ä¼šä¼˜å…ˆç”¨çœŸæ­£çš„å®žçŽ°è¦†ç›–è¿™ä¸ªå¼±å®žçŽ°
  66              	__attribute__((weak)) void set_pin_function(int pin, int function) { (void)pin; (void)function; }
  67              	
  68              	// ç®€å•å»¶æ—¶ï¼ˆä»¿çœŸç”¨ï¼‰
  69              	static void delay_cycles(volatile unsigned int cycles) {
  70 006a 0100     	  while (cycles--) { __asm__ volatile ("nop"); }
  71              	}
  60              		nop
  61              	# 0 "" 2
  62              	 #NO_APP
  63              	.L37:
  64 006c 0100     		nop
  65              		/* loop end a5 .L6 */ 
  66 006e 03250900 		lw	a0,0(s2)
  67 0072 8145     		li	a1,0
  68 0074 97000000 		call	set_gpio_pin_value
  68      E7800000 
  69 007c FBD0017D 		lp.setupi 	x1,2000,(.L36)	 # loop setup, lc+le set
  70              	.L8:
  71              	 #APP
  72              	# 70 "../src/gpio_test/gpio.c" 1
  73              		nop
  74              	# 0 "" 2
  75              	 #NO_APP
  76              	.L36:
  77 0082 0100     		nop
  78              		/* loop end a5 .L8 */ 
  79 0084 1109     		add	s2,s2,4
  80 0086 63054901 		beq	s2,s4,.L21
  81 008a 03250900 		lw	a0,0(s2)
  82 008e E1B7     		j	.L10
  83              	.L21:
  84 0090 13040100 		add	s0,sp,0
  85              	.L9:
  86 0094 0B254400 		p.lw	a0,4(s0!)	# load post inc
  87 0098 8545     		li	a1,1
  88 009a 97000000 		call	set_gpio_pin_value
  88      E7800000 
  89 00a2 E31924FF 		bne	s0,s2,.L9
  90 00a6 9567     		li	a5,20480
  91 00a8 938707E2 		add	a5,a5,-480
  92 00ac FBC03700 		lp.setup  	x1,a5,(.L35)	 # loop setup, lc+le set
  93              	.L12:
  94              	 #APP
  95              	# 70 "../src/gpio_test/gpio.c" 1
  96              		nop
  97              	# 0 "" 2
  98              	 #NO_APP
  99              	.L35:
 100 00b2 0100     		nop
 101              		/* loop end a5 .L12 */ 
 102 00b4 13040100 		add	s0,sp,0
 103              	.L13:
 104 00b8 0B254400 		p.lw	a0,4(s0!)	# load post inc
 105 00bc 8145     		li	a1,0
 106 00be 97000000 		call	set_gpio_pin_value
 106      E7800000 
 107 00c6 E31924FF 		bne	s0,s2,.L13
 108 00ca 9567     		li	a5,20480
 109 00cc 938707E2 		add	a5,a5,-480
 110 00d0 FBC03700 		lp.setup  	x1,a5,(.L34)	 # loop setup, lc+le set
 111              	.L15:
 112              	 #APP
 113              	# 70 "../src/gpio_test/gpio.c" 1
 114              		nop
 115              	# 0 "" 2
 116              	 #NO_APP
 117              	.L34:
 118 00d6 0100     		nop
 119              		/* loop end a5 .L15 */ 
 120 00d8 A149     		li	s3,8
 121              	.L16:
 122 00da 13040100 		add	s0,sp,0
 123              	.L17:
 124 00de 8B244400 		p.lw	s1,4(s0!)	# load post inc
 125 00e2 2685     		mv	a0,s1
 126 00e4 97000000 		call	get_gpio_pin_value
 126      E7800000 
 127 00ec 93351500 		seqz	a1,a0
 128 00f0 2685     		mv	a0,s1
 129 00f2 97000000 		call	set_gpio_pin_value
 129      E7800000 
 130 00fa E31224FF 		bne	s0,s2,.L17
 131 00fe 8967     		li	a5,8192
 132 0100 93870771 		add	a5,a5,1808
 133 0104 FBC03700 		lp.setup  	x1,a5,(.L33)	 # loop setup, lc+le set
 134              	.L19:
 135              	 #APP
 136              	# 70 "../src/gpio_test/gpio.c" 1
 137              		nop
 138              	# 0 "" 2
 139              	 #NO_APP
 140              	.L33:
 141 010a 0100     		nop
 142              		/* loop end a5 .L19 */ 
 143 010c FD19     		add	s3,s3,-1
 144 010e E39609FC 		bnez	s3,.L16
 145 0112 0245     		lw	a0,0(sp)
 146 0114 3DBF     		j	.L20
 148              		.ident	"GCC: (GNU) 7.1.1 20170509"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 gpio.c
     /tmp/cc5ndBC2.s:7      .text.set_pin_function:0000000000000000 set_pin_function
     /tmp/cc5ndBC2.s:14     .text.startup.main:0000000000000000 main
     /tmp/cc5ndBC2.s:63     .text.startup.main:000000000000006c .L37
     /tmp/cc5ndBC2.s:76     .text.startup.main:0000000000000082 .L36
     /tmp/cc5ndBC2.s:99     .text.startup.main:00000000000000b2 .L35
     /tmp/cc5ndBC2.s:117    .text.startup.main:00000000000000d6 .L34
     /tmp/cc5ndBC2.s:140    .text.startup.main:000000000000010a .L33
     /tmp/cc5ndBC2.s:39     .text.startup.main:0000000000000030 .L4
     /tmp/cc5ndBC2.s:83     .text.startup.main:0000000000000090 .L21
     /tmp/cc5ndBC2.s:51     .text.startup.main:0000000000000056 .L10
     /tmp/cc5ndBC2.s:85     .text.startup.main:0000000000000094 .L9
     /tmp/cc5ndBC2.s:103    .text.startup.main:00000000000000b8 .L13
     /tmp/cc5ndBC2.s:123    .text.startup.main:00000000000000de .L17
     /tmp/cc5ndBC2.s:121    .text.startup.main:00000000000000da .L16
     /tmp/cc5ndBC2.s:49     .text.startup.main:0000000000000052 .L20

UNDEFINED SYMBOLS
set_gpio_pin_direction
set_gpio_pin_value
get_gpio_pin_value
